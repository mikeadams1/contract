<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>All Pro Painting Plus - Professional Estimate</title>
<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="All Pro Painting">
<link rel="apple-touch-icon" href="original333.png">
<style>
:root { 
    --allpro-blue: #002D62; 
    --border-heavy: 2px solid var(--allpro-blue); 
}

/* BODY */
body { 
    font-family: "Segoe UI", Arial, sans-serif;
    background-color: #555; 
    margin: 0; padding: 0; padding-bottom: 120px; 
}

/* PAGE SETUP */
.contract-page { 
    background: white; 
    width: 8.5in;
    margin: 20px auto; 
    padding: 0.4in; 
    box-shadow: 0 0 15px rgba(0,0,0,0.5); 
    box-sizing: border-box; 
    position: relative; 
}

/* HEADER */
.top-header { 
    display: grid; 
    grid-template-columns: 1fr 2fr 1fr; 
    border-bottom: var(--border-heavy); 
    padding-bottom: 8px; 
    margin-bottom: 8px;
    align-items: center;
}

.header-left { display: flex; flex-direction: column; gap: 5px; align-items: flex-start; }
.cert-img-osha { height: 35px; width: auto; }
.cert-img-epa { height: 40px; width: auto; }

.header-center { text-align: center; color: var(--allpro-blue); }
.header-center h1 { margin: 0; font-size: 24px; letter-spacing: 1px; text-transform: uppercase; }
.header-center p { margin: 2px 0; font-size: 11px; font-weight: 600; }
.header-center h4 { margin: 8px 0 0 0; font-size: 16px; text-decoration: underline; }

.header-right { color: var(--allpro-blue); font-weight: bold; font-size: 11px; line-height: 1.1; text-align: right; }

/* INFO GRID - IPAD BLEED FIX */
.info-grid { 
    display: grid; 
    grid-template-columns: repeat(4, 1fr); 
    border-top: var(--border-heavy);
    border-left: var(--border-heavy);
    margin-bottom: 10px; 
    background-color: white;
}
.info-cell { 
    border-right: var(--border-heavy); 
    border-bottom: var(--border-heavy); 
    padding: 2px 5px; 
    background-color: white !important;
    position: relative;
    overflow: hidden; 
}
.label { font-size: 8px; font-weight: 800; text-transform: uppercase; display: block; color: var(--allpro-blue); position: relative; z-index: 2; }

/* INPUT IPAD OVERRIDE */
input { 
    border: none; 
    font-family: inherit; 
    font-size: 12px; 
    height: 18px; 
    width: 100%; 
    outline: none; 
    background: transparent !important; 
    -webkit-appearance: none; 
    border-radius: 0;
    position: relative;
    z-index: 1;
}

input:focus, input:-webkit-autofill, textarea:focus {
    -webkit-box-shadow: 0 0 0px 1000px white inset !important;
    box-shadow: 0 0 0px 1000px white inset !important;
}

/* TABLE */
table { width: 100%; border-collapse: collapse; border: var(--border-heavy); margin-bottom: 10px; table-layout: fixed; }
th { border: 1px solid var(--allpro-blue); background: #f0f4f8; padding: 4px; font-size: 10px; color: var(--allpro-blue); }
td { border: 1px solid var(--allpro-blue); padding: 0; vertical-align: top; background: white; }

tr { page-break-inside: avoid !important; break-inside: avoid !important; }

textarea { 
    width: 100%; border: none; font-family: inherit; font-size: 12px; resize: none; 
    background: transparent; padding: 4px; box-sizing: border-box; overflow: hidden; 
    min-height: 24px; line-height: 1.3; display: block; -webkit-appearance: none; outline: none;
}

.print-text { display: none; white-space: pre-wrap; word-wrap: break-word; font-size: 12px; padding: 4px; line-height: 1.3; }

/* PHOTO GRID - WORKING VERSION */
.photo-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px; }
.photo-slot { border: 1px solid var(--allpro-blue); padding: 10px; text-align: center; }
.preview-img { max-width: 100%; max-height: 250px; display: none; margin-top: 10px; border: 1px solid #ccc; }

/* SIGNATURE BLOCK */
.sig-container { border: var(--border-heavy); padding: 8px; background: white; }
#sig-canvas { background: #f0f0f0; cursor: not-allowed; width: 100%; height: 80px; border-bottom: 1px solid #000; margin-top: 5px; opacity: 0.5; }
#sig-canvas.enabled { background: #fff; cursor: crosshair; opacity: 1; }
.sig-controls { display: flex; justify-content: space-between; align-items: center; margin-top: 5px; }

/* TERMS CHECKBOX */
.terms-check-wrapper { background: #fff8e1; border: 1px solid #ffca28; padding: 8px; margin-bottom: 10px; font-size: 11px; display: flex; align-items: center; gap: 10px; color: #333; }
.terms-check-wrapper input[type="checkbox"] { width: 22px; height: 22px; cursor: pointer; }

/* PRINT SETTINGS */
@media print {
    @page { size: Letter; margin: 0.5in; }
    body { background: white; padding: 0; }
    .app-footer, .no-print, input[type="file"], .btn-red, .sig-btn, .terms-check-wrapper { display: none !important; }
    .contract-page { margin: 0; width: 100%; box-shadow: none; border: none !important; padding: 0.1in; }
    .force-break { break-before: page; page-break-before: always; }
    textarea { display: none !important; }
    .print-text { display: block !important; }
    #sig-canvas { background: white !important; opacity: 1 !important; }
}

.app-footer { position: fixed; bottom: 0; width: 100%; background: #111; padding: 20px; display: flex; justify-content: center; gap: 20px; z-index: 1000; }
.btn { padding: 15px 30px; font-weight: bold; cursor: pointer; border: 2px solid white; text-transform: uppercase; border-radius: 4px; }
.btn-blue { background: var(--allpro-blue); color: white; }
.btn-green { background: #27ae60; color: white; }
.sig-btn { background: #eee; border: 1px solid #ccc; font-size: 9px; padding: 2px 5px; cursor: pointer; color: #666; border-radius: 3px; }
.btn-red { background: transparent; color: #cc0000; border:none; cursor:pointer; font-size:10px; margin-top:5px; }
</style>
</head>

<body>

<div class="contract-page">
    <div class="top-header">
        <div class="header-left">
            <img src="lead-safe-certified-firm.png" class="cert-img-epa">
            <img src="original333.png" class="cert-img-osha">
        </div>
        
        <div class="header-center">
            <h1>ALL PRO PAINTING PLUS</h1>
            <p>(518) 701-0308 | www.allpropaintingplus.com</p>
            <h4>RESIDENTIAL PAINTING CONTRACT</h4>
        </div>

        <div class="header-right">
            Quality<br>Service<br>Reliability<br>
            <div style="margin-top: 8px;">
                <span class="label" style="text-align: right;">Date</span>
                <input type="date" id="docDate" style="text-align:right;">
            </div>
        </div>
    </div>

    <div style="border: 3px double var(--allpro-blue); text-align: center; padding: 4px; margin-bottom: 10px; font-weight: bold; color: var(--allpro-blue); font-size: 10px;">
        LICENSED / CERTIFIED / FULLY INSURED / 40 YEARS EXPERIENCE
    </div>

    <div class="info-grid">
        <div class="info-cell" style="grid-column: span 3;"><span class="label">Customer Name</span><input type="text" spellcheck="false" autocomplete="off"></div>
        <div class="info-cell"><span class="label">Phone</span><input type="text" spellcheck="false" autocomplete="off"></div>
        <div class="info-cell" style="grid-column: span 4;"><span class="label">Project Street Address</span><input type="text" spellcheck="false" autocomplete="off"></div>
        <div class="info-cell" style="grid-column: span 2;"><span class="label">City</span><input type="text" spellcheck="false" autocomplete="off"></div>
        <div class="info-cell"><span class="label">State</span><input type="text" value="NY" spellcheck="false" autocomplete="off"></div>
        <div class="info-cell"><span class="label">Zip</span><input type="text" spellcheck="false" autocomplete="off"></div>
        <div class="info-cell" style="grid-column: span 2;"><span class="label">Email</span><input type="text" spellcheck="false" autocomplete="off"></div>
        <div class="info-cell"><span class="label">Start Date</span><input type="date"></div>
        <div class="info-cell"><span class="label">Est. Finish</span><input type="date"></div>
    </div>

    <table>
        <thead>
            <tr>
                <th style="width:20%;">Area</th>
                <th style="width:50%;">Work Description</th>
                <th style="width:15%;">Materials</th>
                <th style="width:15%;">Labor</th>
            </tr>
        </thead>
        <tbody id="rows"></tbody>
    </table>

    <div style="display:grid; grid-template-columns:1.5fr 1fr; gap:15px; margin-top:10px;">
        <div>
            <div class="terms-check-wrapper no-print">
                <input type="checkbox" id="termsAgree" onchange="toggleSignature(this)">
                <label for="termsAgree"><strong>I have read and agree to the Terms & Disclosures on Page 2</strong></label>
            </div>
            <div class="sig-container">
                <span class="label" style="font-size:7px; line-height: 1.1;">Customer Signature and Acceptance: Stipulates authority to enter into Contract and agreement to Payment In Full On Day Of Completion.</span>
                <canvas id="sig-canvas"></canvas>
                <div class="sig-controls">
                    <span style="font-size: 10px; color: var(--allpro-blue); font-weight: bold;">Signature</span>
                    <button class="sig-btn no-print" onclick="clearSig()">Clear Signature</button>
                    <span style="font-size: 10px; color: var(--allpro-blue); font-weight: bold;">Date</span>
                </div>
            </div>
        </div>

        <div style="border:var(--border-heavy); padding:10px; text-align:right; color:var(--allpro-blue); background:white;">
            <div style="font-weight: bold; font-size: 12px;">SUB TOTAL: <span id="lDisp">$0.00</span></div>
            <div style="font-size:10px; margin-top: 3px;">NY Sales Tax: <input type="number" id="tax" style="width:60px; border-bottom: 1px solid var(--allpro-blue); text-align: right;" onchange="calcTotal()"></div>
            <div style="font-size:16px; font-weight:bold; border-top:2px solid var(--allpro-blue); margin-top:5px; padding-top:5px;">
                TOTAL DUE: <span id="gDisp">$0.00</span>
            </div>
            <p style="font-size:10px; margin-top:10px; font-weight: bold;">Contractors Signature</p>
        </div>
    </div>
</div>

<div class="contract-page force-break">
    <h3 style="color:#002D62; border-bottom:2px solid #002D62; padding-bottom:4px; margin-top: 0; font-size: 14px;">TERMS & DISCLOSURES</h3>
    <div style="font-size:10px; line-height:1.3; text-align: justify; color: #333;">
        <p><strong>WORK AUTHORIZATION & BINDING AGREEMENT:</strong> By executing this contract, the Customer certifies that they have read this document and all accompanying pages in its entirety and expressly agrees to all terms, conditions, and facts stated herein. The Customer authorizes All Pro Painting Plus to perform the services described. <strong>TITLE TO MATERIALS:</strong> It is strictly understood that all materials purchased and installed by All Pro Painting Plus remain the sole property of the Contractor until the contract balance is paid in full. The Customer agrees to the payment terms specified on the face of this document and acknowledges that project completion dates are good-faith estimates.</p>
        
        <p><strong>UNFORESEEN CONDITIONS:</strong> In the event that any additional unforeseen work is discovered and required to complete the terms of this contract or the scope of work agreed to in this contract, consumer agrees to pay any additional reasonable fees to accomplish the same. Consumer, property owner, or general contractor agrees that unforeseen work discovered after the job has been opened, or absent any destructive investigation where upon visual inspection of the areas were unknown to the contractor and consumer, the consumer agrees to amend this contract regarding the same and agrees to pay additional reasonable amounts for the work to be completed. Customer further agrees to To protect the integrity and reputation of the Contractor, the Customer agrees to refrain from making any disparaging, negative, or defamatory statements, whether written or verbal, regarding the Contractor, their employees, or the services provided. This includes, but is not limited to, the posting of negative reviews or comments on any Internet-based social media or review platform. This non-disparagement agreement is a permanent and material condition of this contract.</p>

        <p><strong>SITE SAFETY & ACCESS:</strong> You agree to allow us to do our work unsupervised and unfettered. You agree to allow contractor access to the job site and that once the work has commenced that you the customer are prohibited from access to the worksite for safety reasons to maintain a safe working environment in conformity with OSHA Regulations. All children must be kept from project work site, no exceptions. All elderly and those with physical disabilities are prohibited from worksite while any work is being performed.</p>

        <p>><strong>THE CONTRACT:</strong> The condition specifications and prices stated in this Contract and any referenced attachment herein are satisfactory and are hereby accepted by customer signing this contract physically and/or by verbal authorization, text or electronic communication indicating that the customer agrees to be bound to the contract in its entirety. The customer further agrees that the Contractor is authorized to do the work as specified on the face of the document in its entirety.<p>
        
        <p><strong>PAYMENT TERMS:</strong> The amount stipulated on the front of this contract is due on the day of project completion along with any amounts that are added to the contract due to change work orders that are verbally and/or in writing agreed to. Your payment signifies that you the consumer are 100% satisfied and that the job is completed to your satisfaction and that no other work needs to be done in regards to the same. We do not take credit cards for payment. Payment must be made by a local check, cash, wire transfer, or certified check from a local bank.</p>
    </div>
</div>

<div id="photoPagesContainer"></div>

<div class="app-footer">
    <button class="btn btn-blue" onclick="addRow()">+ Add Line</button>
    <button class="btn btn-blue" onclick="addNewPhoto()">+ Add Photo</button>
    <button class="btn btn-green" onclick="window.print()">Generate PDF</button>
</div>

<script>
document.getElementById('docDate').valueAsDate = new Date();

function addRow(){ 
    const tr=document.createElement('tr'); 
    tr.innerHTML=`
        <td><textarea oninput="autoExpand(this)" spellcheck="false" autocomplete="off"></textarea><div class="print-text"></div></td>
        <td><textarea oninput="autoExpand(this)" spellcheck="false" autocomplete="off"></textarea><div class="print-text"></div></td>
        <td><input type="text" onchange="calcTotal()" spellcheck="false" autocomplete="off"></td>
        <td><input type="number" class="lab" onchange="calcTotal()"></td>`; 
    document.getElementById('rows').appendChild(tr); 
}
for(let i=0;i<1;i++) addRow();

function autoExpand(el){ 
    el.style.height="auto"; 
    el.style.height=el.scrollHeight+"px"; 
    const printDiv = el.parentElement.querySelector('.print-text');
    if(printDiv) printDiv.innerText = el.value;
}

function calcTotal(){
    let l=0; document.querySelectorAll('.lab').forEach(i=>l+=Number(i.value)||0);
    let t=Number(document.getElementById('tax').value)||0;
    lDisp.innerText='$'+l.toFixed(2); gDisp.innerText='$'+(l+t).toFixed(2);
}

let sigEnabled = false;
function toggleSignature(cb) {
    const cvs = document.getElementById('sig-canvas');
    if (cb.checked) { cvs.classList.add('enabled'); sigEnabled = true; } 
    else { cvs.classList.remove('enabled'); sigEnabled = false; clearSig(); }
}

let photoTotal=0;
function addNewPhoto(){
    photoTotal++;
    let container = document.getElementById('photoPagesContainer');
    let pages = container.querySelectorAll('.photo-page');
    let last = pages[pages.length-1];
    if(!last || last.querySelector('.photo-grid').querySelectorAll('.photo-slot').length >= 4){
        last = document.createElement('div');
        last.className = 'contract-page photo-page force-break';
        last.innerHTML = `<h2 style="border-bottom:var(--border-heavy);color:var(--allpro-blue); margin-top:0; font-size: 16px;">PROJECT PHOTO LOG</h2><div class="photo-grid"></div>`;
        container.appendChild(last);
    }
    const slot = document.createElement('div');
    slot.className = 'photo-slot';
    const id = 'img-' + photoTotal;
    slot.innerHTML = `
        <span class="label">Description</span>
        <textarea oninput="autoExpand(this)" spellcheck="false" autocomplete="off"></textarea><div class="print-text"></div>
        <input type="file" accept="image/*" onchange="pv(this,'${id}')" class="no-print">
        <img id="${id}" class="preview-img">
        <button class="btn-red" onclick="this.parentElement.remove()">Remove</button>`;
    last.querySelector('.photo-grid').appendChild(slot);
}

function pv(input,id){ 
    if(input.files&&input.files[0]){ 
        let r=new FileReader(); 
        r.onload=e=>{ let img=document.getElementById(id); img.src=e.target.result; img.style.display='block'; }; 
        r.readAsDataURL(input.files[0]); 
    } 
}

const canvas=document.getElementById('sig-canvas'); const ctx=canvas.getContext('2d');
function clearSig() { ctx.clearRect(0, 0, canvas.width, canvas.height); }
function resizeCanvas(){ 
    const ratio=window.devicePixelRatio||1; 
    canvas.width=canvas.offsetWidth*ratio; canvas.height=canvas.offsetHeight*ratio; 
    ctx.scale(ratio,ratio); ctx.lineWidth=2; ctx.strokeStyle="#000";
}
resizeCanvas(); window.addEventListener('resize',resizeCanvas);
let drawing=false;
function pos(e){ 
    const r=canvas.getBoundingClientRect(); 
    return{ x:(e.touches?e.touches[0].clientX:e.clientX)-r.left, y:(e.touches?e.touches[0].clientY:e.clientY)-r.top }; 
}
canvas.addEventListener('mousedown',e=>{ if(!sigEnabled) return; drawing=true; ctx.beginPath(); let p=pos(e); ctx.moveTo(p.x,p.y); });
canvas.addEventListener('mousemove',e=>{ if(!drawing || !sigEnabled)return; let p=pos(e); ctx.lineTo(p.x,p.y); ctx.stroke(); });
window.addEventListener('mouseup',()=>drawing=false);
canvas.addEventListener('touchstart',e=>{ if(!sigEnabled) return; drawing=true; ctx.beginPath(); let p=pos(e); ctx.moveTo(p.x,p.y); },{passive:false});
canvas.addEventListener('touchmove',e=>{ if(!drawing || !sigEnabled)return; e.preventDefault(); let p=pos(e); ctx.lineTo(p.x,p.y); ctx.stroke(); },{passive:false});
</script>
</body>
</html>

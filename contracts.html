<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>All Pro Painting Plus - Professional Estimate</title>

<style>
:root { 
    --allpro-blue: #002D62; 
    --border-heavy: 2px solid var(--allpro-blue); 
}

/* BODY */
body { 
    font-family: "Segoe UI", Arial, sans-serif;
    background-color: #555; 
    margin: 0; 
    padding: 0; 
    padding-bottom: 120px; 
}

/* PAGE SETUP */
.contract-page { 
    background: white; 
    width: 8.5in;
    min-height: 10.5in;
    margin: 20px auto; 
    padding: 0.4in; 
    box-shadow: 0 0 15px rgba(0,0,0,0.5); 
    box-sizing: border-box; 
    position: relative; 
    page-break-after: always;
}

/* HEADER */
.top-header { 
    display: grid; 
    grid-template-columns: 1fr 1.2fr;
    border-bottom: var(--border-heavy); 
    padding-bottom: 12px; 
    margin-bottom: 12px;
}

.brand-side { color: var(--allpro-blue); }
.brand-side h1 { margin: 0 0 4px 0; font-size: 26px; letter-spacing: 1px; font-weight: 700; }
.brand-side p { margin: 1px 0; line-height: 1.2; font-size: 13px; }

.cert-side { text-align: right; }

.badge-row {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: 15px;
    margin-bottom: 8px;
}

.cert-img-osha { height: 50px; width: auto; }
.cert-img-epa { height: 55px; width: auto; }

/* INFO GRID */
.info-grid { 
    display: grid; 
    grid-template-columns: 1fr 1fr; 
    border: var(--border-heavy); 
    margin-bottom: 15px; 
}
.info-cell { border: 1px solid var(--allpro-blue); padding: 2px 6px; }
.label { font-size: 9px; font-weight: 600; text-transform: uppercase; display: block; margin-bottom: 1px; color: var(--allpro-blue); }
input { border: none; font-family: inherit; font-size: 13px; height: 16px; width: 100%; outline: none; background: transparent; }

/* TABLE */
table { width: 100%; border-collapse: collapse; border: var(--border-heavy); margin-bottom: 10px; table-layout: fixed; }
th { border: 1px solid var(--allpro-blue); background: #f0f4f8; padding: 6px; font-size: 11px; color: var(--allpro-blue); }
td { border: 1px solid var(--allpro-blue); padding: 0; vertical-align: top; }
textarea { width: 100%; border: none; font-family: inherit; font-size: 12px; resize: none; background: transparent; padding: 4px; box-sizing: border-box; overflow: hidden; min-height: 26px; line-height: 1.2; display: block; }

/* PHOTO GRID */
#photoPagesContainer { page-break-before: always; }
.photo-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.photo-slot { border: 1px solid var(--allpro-blue); padding: 10px; background: #fff; display: flex; flex-direction: column; height: 320px; page-break-inside: avoid; }
.preview-img { max-width: 100%; max-height: 200px; margin: auto; display: none; border: 1px solid #333; object-fit: contain; }

/* PRINT SETTINGS */
@media print {
    @page { size: Letter; margin: 0; }
    body { background: white; padding: 0; }
    .app-footer, .no-print, input[type="file"], .btn-red { display: none !important; }
    .contract-page { margin: 0; width: 100%; box-shadow: none; border: none !important; }
    .force-break { page-break-before: always; }
}

.app-footer { position: fixed; bottom: 0; width: 100%; background: #111; padding: 20px; display: flex; justify-content: center; gap: 20px; z-index: 1000; }
.btn { padding: 15px 30px; font-weight: bold; cursor: pointer; border: 2px solid white; text-transform: uppercase; border-radius: 4px; }
.btn-blue { background: var(--allpro-blue); color: white; }
.btn-green { background: #27ae60; color: white; }
.btn-red { background: transparent; color: #cc0000; border:none; cursor:pointer; font-size:12px; font-weight: bold; padding: 5px; }
</style>
</head>

<body>

<div class="contract-page">
    <div class="top-header">
        <div class="brand-side">
            <h1>ALL PRO PAINTING PLUS</h1>
            <p>Servicing The Capital Region</p>
            <p>& The North Country</p>
            <p>(518) 701-0308</p>
            <p>www.allpropaintingplus.com</p>
        </div>

        <div class="cert-side">
            <div class="badge-row">
                <img src="lead-safe-certified-firm.png" alt="EPA Lead Safe" class="cert-img-epa">
                <img src="original333.png" alt="OSHA Certified" class="cert-img-osha">
            </div>
            <div style="margin-top:5px;">
                <span class="label">Residential Contract #</span>
                <input type="text" style="text-align:right; font-weight:bold;">
                <span class="label">Document Date</span>
                <input type="date" id="docDate" style="text-align:right;">
            </div>
        </div>
    </div>

    <div style="border: 3px double var(--allpro-blue); text-align: center; padding: 8px; margin-bottom: 15px; font-weight: bold; color: var(--allpro-blue);">
        LICENSED / CERTIFIED / FULLY INSURED / 40 YEARS EXPERIENCE
    </div>

    <div class="info-grid">
        <div class="info-cell" style="grid-column: span 2;"><span class="label">Customer / Property Owner</span><input type="text"></div>
        <div class="info-cell" style="grid-column: span 2;"><span class="label">Project Property Address</span><input type="text"></div>
        <div class="info-cell"><span class="label">Primary Phone</span><input type="text"></div>
        <div class="info-cell"><span class="label">Project Start Date</span><input type="date"></div>
        <div class="info-cell"><span class="label">Email Address</span><input type="text"></div>
        <div class="info-cell"><span class="label">Est. Completion Date</span><input type="date"></div>
    </div>

    <table>
        <thead>
            <tr>
                <th style="width:25%;">Area</th>
                <th style="width:45%;">Work Description</th>
                <th style="width:14%;">Materials</th>
                <th style="width:14%;">Labor</th>
                <th style="width:2%;" class="no-print"></th>
            </tr>
        </thead>
        <tbody id="rows"></tbody>
    </table>

    <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-top:15px; page-break-inside: avoid;">
        <div style="border:var(--border-heavy); padding:10px;">
            <span class="label" style="font-size: 8px; line-height: 1.1;">Customers Signature and Acceptance of this Contract and Terms Stipulates that You have the authority to enter into this Contract and agree to make Payment In Full On The Day Of Completion by Local Check, Cash, or by Fed Wire at the contractors direction.</span>
            <canvas id="sig-canvas" style="width:100%; height:90px;"></canvas>
        </div>
        <div style="border:var(--border-heavy); padding:10px; text-align:right; color:var(--allpro-blue);">
            <div>Material TOTAL: <span id="mDisp">$0.00</span></div>
            <div>Labor TOTAL: <span id="lDisp">$0.00</span></div>
            <div style="font-size:10px;">NY State Sales Tax: <input type="number" id="tax" style="width:60px; border-bottom: 1px solid #ccc;" onchange="calcTotal()" value="0"></div>
            <div style="font-size:20px; font-weight:bold; border-top:2px solid var(--allpro-blue); margin-top:5px; padding-top:5px;">
                TOTAL: <span id="gDisp">$0.00</span>
                <p style="font-size: 10px; margin: 5px 0 0 0;">Contractors Signature</p>
            </div>
        </div>
    </div>
</div>

<div id="photoPagesContainer"></div>

<div class="contract-page force-break">
    <h3 style="color:#002D62; border-bottom:2px solid #002D62; padding-bottom:6px; margin-top: 0;">CONTRACT TERMS & LEGAL DISCLOSURES</h3>
    <div style="font-size:10px; line-height:1.4; text-align: justify;">
        <p><strong>LEGAL DISCLOSURES:</strong> Pursuant to New York State General Business Law the following disclosures listed herein are understood and accepted by the party signing this contract for services and as the consumer, by my signature executed on this contract, I agree that I have read the same and fully understand and agree to be bound by all the terms stated herein. Pursuant to GBL 771(1)(h) you have a right to cancel this contract within three business days. See, GBL ยง 771(1)(h). In addition to any right otherwise to revoke an offer, the owner may cancel the home improvement contract until midnight of the third business day after the day on which the owner has signed an agreement or offer to purchase relating to such contract.</p>

        <p><strong>WORK AUTHORIZATION & BINDING AGREEMENT:</strong> By executing this contract, the Customer certifies that they have read this document and all accompanying pages in its entirety and expressly agrees to all terms, conditions, and facts stated herein. The Customer authorizes All Pro Painting Plus to perform the services described. <strong>TITLE TO MATERIALS:</strong> It is strictly understood that all materials purchased and installed by All Pro Painting Plus remain the sole property of the Contractor until the contract balance is paid in full.</p>

        <p><strong>ANTI-DISPARAGEMENT CLAUSE:</strong> To protect the integrity and reputation of the Contractor, the Customer agrees to refrain from making any disparaging, negative, or defamatory statements of any kind, whether written, verbal, or electronic, regarding the Contractor, their employees, or the services provided. This includes, but is not limited to, the posting of reviews or comments on any internet-based social media or review platform. This is a permanent and material condition of this contract.</p>
        
        <p><strong>UNFORESEEN CONDITIONS:</strong> In the event that any additional unforeseen work is discovered and required to complete the terms of this contract (absent any destructive investigation where upon visual inspection of the areas were unknown to the contractor), the consumer agrees to amend this contract regarding the same and agrees to pay additional reasonable amounts for the work to be completed.</p>

        <p><strong>SITE SAFETY & ACCESS:</strong> Pursuant to OSHA Regulations, the worksite is a restricted area. Customer agrees to allow contractor unsupervised access. For safety reasons, customers, children, the elderly, and those with disabilities are strictly prohibited from the worksite while work is being performed. All children must be kept from project work site, no exceptions.</p>

        <p><strong>PAYMENT TERMS:</strong> Total balance is due on the day of project completion. Payment signifies that the consumer is 100% satisfied and the job is completed to your satisfaction. We do not take credit cards. Payment must be made by local check, cash, wire transfer, or certified check.</p>
    </div>
</div>

<div class="app-footer no-print">
    <button class="btn btn-blue" onclick="addRow()">+ Add Line</button>
    <button class="btn btn-blue" onclick="addNewPhoto()">+ Add Photo</button>
    <button class="btn btn-green" onclick="window.print()">Generate PDF</button>
</div>

<script>
document.getElementById('docDate').valueAsDate = new Date();

function autoExpand(el){ 
    el.style.height="auto"; 
    el.style.height=el.scrollHeight+"px"; 
}

function addRow(){ 
    const tr=document.createElement('tr'); 
    tr.innerHTML=`
        <td><textarea oninput="autoExpand(this)" placeholder="Area"></textarea></td>
        <td><textarea oninput="autoExpand(this)" placeholder="Work Details"></textarea></td>
        <td><input type="number" class="mat" onchange="calcTotal()" value="0"></td>
        <td><input type="number" class="lab" onchange="calcTotal()" value="0"></td>
        <td class="no-print"><button class="btn-red" onclick="this.parentElement.parentElement.remove(); calcTotal();">X</button></td>`; 
    document.getElementById('rows').appendChild(tr); 
}

for(let i=0;i<1;i++) addRow();

function calcTotal(){
    let m=0,l=0;
    document.querySelectorAll('.mat').forEach(i=>m+=Number(i.value)||0);
    document.querySelectorAll('.lab').forEach(i=>l+=Number(i.value)||0);
    let t=Number(document.getElementById('tax').value)||0;
    
    document.getElementById('mDisp').innerText='$'+m.toFixed(2); 
    document.getElementById('lDisp').innerText='$'+l.toFixed(2); 
    document.getElementById('gDisp').innerText='$'+(m+l+t).toFixed(2);
}

let photoTotal=0;
function addNewPhoto(){
    photoTotal++;
    let container = document.getElementById('photoPagesContainer');
    let pages = container.querySelectorAll('.photo-page');
    let last = pages[pages.length-1];
    if(!last || last.querySelectorAll('.photo-slot').length >= 6){
        last = document.createElement('div');
        last.className = 'contract-page photo-page';
        last.innerHTML = `<h2 style="border-bottom:var(--border-heavy);color:var(--allpro-blue); margin-top:0;">PROJECT PHOTO LOG</h2><div class="photo-grid"></div>`;
        container.appendChild(last);
    }
    const slot = document.createElement('div');
    slot.className = 'photo-slot';
    const id = 'img-' + photoTotal;
    slot.innerHTML = `<span class="label">Photo Description</span><input type="text"><input type="file" accept="image/*" onchange="pv(this,'${id}')" class="no-print"><img id="${id}" class="preview-img"><button class="btn-red" onclick="this.parentElement.remove()">Remove Photo</button>`;
    last.querySelector('.photo-grid').appendChild(slot);
}

function pv(input,id){ 
    if(input.files&&input.files[0]){ 
        let r=new FileReader(); 
        r.onload=e=>{ 
            let img=document.getElementById(id); 
            img.src=e.target.result; 
            img.style.display='block'; 
        }; 
        r.readAsDataURL(input.files[0]); 
    } 
}

const canvas=document.getElementById('sig-canvas'); const ctx=canvas.getContext('2d');
function resizeCanvas(){ 
    const ratio=window.devicePixelRatio||1; 
    canvas.width=canvas.offsetWidth*ratio; 
    canvas.height=canvas.offsetHeight*ratio; 
    ctx.scale(ratio,ratio); 
    ctx.lineWidth=2; 
}
resizeCanvas(); window.addEventListener('resize',resizeCanvas);

let drawing=false;
function pos(e){ 
    const r=canvas.getBoundingClientRect(); 
    const clientX = e.touches ? e.touches[0].clientX : e.clientX;
    const clientY = e.touches ? e.touches[0].clientY : e.clientY;
    return{ x: clientX - r.left, y: clientY - r.top }; 
}

canvas.addEventListener('mousedown',e=>{ drawing=true; ctx.beginPath(); let p=pos(e); ctx.moveTo(p.x,p.y); });
canvas.addEventListener('mousemove',e=>{ if(!drawing)return; let p=pos(e); ctx.lineTo(p.x,p.y); ctx.stroke(); });
window.addEventListener('mouseup',()=>drawing=false);

canvas.addEventListener('touchstart',e=>{ 
    drawing=true; 
    ctx.beginPath(); 
    let p=pos(e); 
    ctx.moveTo(p.x,p.y); 
},{passive:false});

canvas.addEventListener('touchmove',e=>{ 
    if(!drawing)return; 
    e.preventDefault(); 
    let p=pos(e); 
    ctx.lineTo(p.x,p.y); 
    ctx.stroke(); 
},{passive:false});
</script>
</body>
</html>
